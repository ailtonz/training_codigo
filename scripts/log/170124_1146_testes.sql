USE [DB_SISCOB]
GO

/****** Object:  View [APP_EXCEL].[VW_CONSUMO_CONSOLIDADO_ANALISTA]    Script Date: 1/24/2017 11:18:04 AM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [APP_EXCEL].[VW_CONSUMO_CONSOLIDADO_ANALISTA__DEZ_2016]
AS

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT 
--top 10
	'DEZ_2016'														AS DADOS_PERIDO
	,C.RAIZ_GRUPO
	,C.SEG_DESCR
	,C.INTERCOMPANY
	,V1.SALDO_CAR													AS SALDO_CAR_26
	,V2.SALDO_CAR													AS SALDO_CAR_05
	,VN.SALDO_CAR													AS SALDO_CAR_30
	,V3.SALDO_CAR													AS SALDO_CAR_14
	,V4.SALDO_CAR													AS SALDO_CAR_21
	,V5.SALDO_CAR													AS SALDO_CAR_25
	,V1.NV_FX_ARRECADA												AS FAIXA_ARRECADA_INICIAL
	,VA.NV_FX_ARRECADA												AS FAIXA_ARRECADA_ATUAL
	,C.TIPO	

  FROM 
					[BKP].[2016_12_TB_CONSUMO_SISCOB]		CS
		INNER JOIN  [CONSOLIDADO].[TB_CONSOLIDADO]			C	ON C.ID						= CS.ID_CONSOLIDADO 
		INNER JOIN  [AUXILIAR].[TB_SEGMENTO]				SG	ON SG.ID					= C.ID_SEGMENTO
		INNER JOIN	[AUXILIAR].[TB_PERIODO]					P   ON P.ID						= C.ID_PERIODO
		INNER JOIN  [AUXILIAR].[TB_TIPO]					TP  ON C.ID_TIPO                = TP.ID
		
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  V1	ON CS.ID_VALORES_26			= V1.ID
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  V2	ON CS.ID_VALORES_05			= V2.ID
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  V3	ON CS.ID_VALORES_14			= V3.ID
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  V4	ON CS.ID_VALORES_21			= V4.ID
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  V5	ON CS.ID_VALORES_25			= V5.ID
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  VA	ON CS.ID_VALOR_ATUAL		= VA.ID
		LEFT  JOIN  [CONSOLIDADO].[TB_DADOS_E_VALORES]  VN	ON CS.ID_VALORES_30			= VN.ID
		
		
 --WHERE
	--	--C.ID_PERIODO = (SELECT MAX(ID) FROM [AUXILIAR].[TB_PERIODO])
		
	--	 V1.SALDO_CAR is not null
	--	and V2.SALDO_CAR is not null
	--	--and VN.SALDO_CAR is not null
	--	and V3.SALDO_CAR is not null
	--	and V4.SALDO_CAR is not null
	--	and V5.SALDO_CAR is not null





GO


